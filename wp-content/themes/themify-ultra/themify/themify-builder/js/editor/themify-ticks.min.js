'use strict';var TB_Ticks;
(function(d){TB_Ticks={interval:null,time:2E4,$el:null,options:null,request:null,iframe:null,init(b,a){var c=TB_Ticks;c.options=b;c.time=1E3*parseInt(b.tick);c.$el=d("#tmpl-builder-restriction");c.iframe=a;return c},ticks(){function b(c){if(c&&1!==Number(c)){a.request.abort();clearInterval(a.interval);document.body.insertAdjacentHTML("beforeend",c);a.$el=d("#tmpl-builder-restriction");a.show();a.iframe.ThemifyBuilderCommon.showLoader("show");var e=a.iframe.tb_app;e.Views.Toolbar.prototype.Revisions.saveRevision(a.$el.find(".tb_locked_revision").text(),function(){a.iframe.ThemifyBuilderCommon.showLoader("hide");
e.Models.Registry.destroy()})}}var a=TB_Ticks;null!==a.interval&&clearInterval(a.interval);a.interval=setInterval(function(){a.ajax(b,null)},a.time);d(document).off("heartbeat-tick",b).on("heartbeat-tick",function f(e,g){"undefined"!==typeof g["wp-refresh-post-lock"].lock_error&&(a.request.abort(),clearInterval(a.interval),d(document).off("heartbeat-tick",f))});return a},ajax(b,a){var c=TB_Ticks;c.request=d.ajax({type:"POST",url:themify_vars.ajax_url,data:{action:"tb_update_tick",postID:c.options.postID,
take:a},success:b})},isEditing(){return document.body.classList.contains("tb_restriction")},show(){var b=TB_Ticks;b.$el.show();b.close();b.takeOver()},hide(){TB_Ticks.$el.hide()},takeOver(){var b=TB_Ticks;Themify.body.one("click",".tb_locked_btn",function(a){a.preventDefault();a.stopPropagation();b.ajax(function(){Themify.is_builder_active||Themify.body.hasClass("wp-admin")?b.ticks():(Themify.body.removeClass("tb_restriction"),d(".js-turn-on-builder").first().trigger("click"));b.$el.remove()},1)})},
close(){this.$el.one("click",".tb_locked_close",this.hide)}}})(jQuery);
